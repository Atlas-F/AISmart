### 开发日志

**2025.6.13 V1.0**

​	编写项目文档。

休眠界面表情图间隔一秒随机切换完成，在UI.C中screen对象下调用事件回调函数InitAutoScreenChange（），函数实现在ui_event.c中实现创建定时器初始化函数和定时器回调函数。

load之前创建定时器，如果是unload则删除定时器节省资源。

使用Square Line进行快捷设计导出时部分源码文件会被覆盖掉，高危操作，要注意提前保护





**2025.6.14 V1.0**

​	使用保护块

```
/* [USER CODE BEGIN critical] */
/* 保护注释（重要！） */
must_survive(); 
/* [USER CODE END critical] */
```

保护块似乎只对个别文件或者代码块起作用，ui.c每次都会被覆盖，ui_event.c

在UIevent.c中存储自定义的事件函数（应该在外部再设置自定义文件将自定义函数存储在里面，放置被覆盖）

自定义的函数不会被覆盖

手势滑动切换屏幕

设置手势向下滑切换时间日期显示屏幕（后续可以设置变换颜色）

ui.c内使用外部定时器需要声明外部变量



在第二屏设置模拟AI与人类对话，显示文本 

**待解决：**

​	点击对话框刷新文本内容



添加了时间与日期显示界面，在主界面通过手势向下滑动进入时间界面，该界面下可以进入第二屏和第三屏。

实现方式：

​	通过time结构体，调用不同的成员量获取准确时间戳，

​	在主界面的加载函数里设置定时器，以消除时间界面加载的空白窗口，使得时间界面进入就可以显示



**2025.6.15 V1.0**

第二屏点击设置label的文本要嫁给点击事件设置在label的父级panel上。

标准IO 对同一个文件流操作，要确保作用域的范围正确，或者借助fseek函数进行控制。

可以将该文件的文件流设置为全局变量

笔记：

- 文件流在函数内被定义时，作用域仅限于该函数

- 问价流作为参数传递给函数时，作用域取决于定义它的位置

- 传递文件流指针时，副本指针的作用域在函数内，但是文件流对象的生命周期由原函数控制

- 只要原函数指针未关闭文件流（未调用fclose），文件流对象就持续有效

- 生命周期与作用域的概念不同。

- 文件指针的位置由文件流对象维护，与指针变量本身的作用域无关。

- **返回局部文件流时，文件指针保留上一次操作后的位置，后续写从该位置继续。虽然局部变量在函数返回后失效，但是返回指向动态分配内存的指针是合法的。。。？**

- #### **文件指针的本质**

  - 文件指针（位置指示器）是**文件流对象（`FILE`结构体）的内部成员**，记录当前读写位置。
  - 只要文件流对象未关闭（即未调用`fclose`），其内部的文件指针就会持续更新。



点击humanpanel一下，更新一次文本内容

在使用文件模拟数据时，模拟器时不支持中文标点符号，需要替换成英文标点符号 。

对话文本文件的路径使用在虚拟机上的绝对路径



目前基本功能已经完成：

使用数据文件模拟对话，点击一下huamanlabel代表一次 交互，AI与人类轮流输出内容。

后续可以在时间面板加入模拟天气的功能，使用图标代表天气

开发板上面可以正常移植，但是时间戳有问题

问题：GEC6818开发板上日期与实际不符，可能是无法通过网络获取时间戳的原因？？



后续功能设计：

加载第三幕和第四幕时， 在进入屏幕时屏幕随机滚动显示几个图标两秒或者三秒，后选中一个放大显示，叫做吃什么选择器

​	